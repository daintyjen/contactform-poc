<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Newsletter Signup Form</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }

        .form-container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .form-title {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
            font-size: 28px;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            background-color: #fff;
        }

        .form-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 30px;
        }

        .checkbox-input {
            width: 18px;
            height: 18px;
            margin-top: 2px;
            cursor: pointer;
        }

        .checkbox-label {
            font-size: 14px;
            color: #555;
            cursor: pointer;
            line-height: 1.4;
        }

        .submit-button {
            width: 100%;
            background-color: #007bff;
            color: white;
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }

        .submit-button:hover {
            background-color: #0056b3;
        }

        .submit-button:active {
            transform: translateY(1px);
        }

        .required {
            color: #dc3545;
        }

        @media (max-width: 600px) {
            .form-container {
                padding: 30px 20px;
                margin: 10px;
            }
            
            .form-title {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h1 class="form-title">Newsletter Signup</h1>
        
        <form id="newsletterForm" method="post">
            <div class="form-group">
                <label for="firstName" class="form-label">
                    First Name <span class="required">*</span>
                </label>
                <input 
                    type="text" 
                    id="firstName" 
                    name="firstName" 
                    class="form-input" 
                    required
                    placeholder="Enter your first name"
                >
            </div>

            <div class="form-group">
                <label for="lastName" class="form-label">
                    Last Name <span class="required">*</span>
                </label>
                <input 
                    type="text" 
                    id="lastName" 
                    name="lastName" 
                    class="form-input" 
                    required
                    placeholder="Enter your last name"
                >
            </div>

            <div class="form-group">
                <label for="email" class="form-label">
                    Email Address <span class="required">*</span>
                </label>
                <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    class="form-input" 
                    required
                    placeholder="Enter your email address"
                >
            </div>

            <div class="checkbox-group">
                <input 
                    type="checkbox" 
                    id="newsletter" 
                    name="newsletter" 
                    class="checkbox-input"
                >
                <label for="newsletter" class="checkbox-label">
                    I would like to subscribe to the newsletter and receive updates about new content, promotions, and company news.
                </label>
            </div>

            <button type="submit" class="submit-button">
                Subscribe Now
            </button>
        </form>
    </div>

    <!-- Microsoft Dynamics 365 Marketing Form Capture Script -->
    <script src='https://cxppusa1formui01cdnsa01-endpoint.azureedge.net/usa/FormCapture/FormCapture.bundle.js'></script>
    <script>
        // NOTE: for reference see https://go.microsoft.com/fwlink/?linkid=2250770
        d365mktformcapture.waitForElement("#newsletterForm") // Form selector matching the form id
        .then(form => {
            const mappings = [
                {
                    FormFieldName: "firstName", // Matches the name attribute of first name input
                    DataverseFieldName: "firstname",
                },
                {
                    FormFieldName: "lastName", // Matches the name attribute of last name input
                    DataverseFieldName: "lastname",
                },
                {
                    FormFieldName: "email", // Matches the name attribute of email input
                    DataverseFieldName: "emailaddress1",
                }/*,
                {
                    FormFieldName: "newsletter", // Matches the name attribute of newsletter checkbox
                    DataverseFieldName: "msdynmkt_topicid;channels;optinwhenchecked",
                    DataverseFieldValue: "fda62239-dc70-f011-bec2-000d3a11bb02;Email;true",
                },*/
            ];
            
            form.addEventListener("submit", (e) => {
                const serializedForm = d365mktformcapture.serializeForm(form, mappings);
                // console.log(JSON.stringify(serializedForm)); // NOTE: enable for debugging
                const payload = serializedForm.SerializedForm.build();
                const captureConfig = {
                    FormId: "753ede66-db70-f011-bec2-000d3a11bb02",
                    FormApiUrl: "https://public-usa.mkt.dynamics.com/api/v1.0/orgs/7b97bdf6-ba6f-f011-8587-00224820bd18/landingpageforms"
                }
                d365mktformcapture.submitForm(captureConfig, payload);
            }, true);
        });
    </script>
</body>
</html>
